\documentclass[a4paper, titlepage, oneside, 12pt]{article}%      autres choix : book  report

\usepackage[utf8]{inputenc}%           gestion des accents (source)
\usepackage[T1]{fontenc}%              gestion des accents (PDF)
\usepackage[francais]{babel}%          gestion du français
\usepackage{textcomp}%                 caractères additionnels
\usepackage{mathtools,  amssymb, amsthm}% packages de l'AMS + mathtools
\usepackage{lmodern}%                  police de caractère
\usepackage{geometry}%                 gestion des marges
\usepackage{graphicx}%                 gestion des images
\usepackage{xcolor}%                   gestion des couleurs
\usepackage{array}%                    gestion améliorée des tableaux
\usepackage{calc}%                     syntaxe naturelle pour les calculs
\usepackage{titlesec}%                 pour les sections
\usepackage{titletoc}%                 pour la table des matières
\usepackage{fancyhdr}%                 pour les en-têtes
\usepackage{titling}%                  pour le titre
\usepackage[framemethod=TikZ]{mdframed}% print frames
\usepackage{caption}%                  for captionof
\usepackage{listings}
\usepackage{enumitem}%                 pour les listes numérotées
\usepackage{microtype}%                améliorations typographiques
\usepackage{csvsimple}%                 convertir un fichier .csv en tableau
\usepackage{fullpage}

\usepackage{hyperref}%                 gestion des hyperliens

\usepackage{titling} %  				  gestion des subtitles 
\newcommand{\subtitle}[1]{%			  definition d'une nouvelle commande sous-titre
  \posttitle{%
    \par\end{center}
    \begin{center}\large#1\end{center}
    \vskip0.5em}%
}                

\hypersetup{%
    pdfborder = {0 0 0}
}


                                    
\title{Rapport de Projet d'ACII}
\subtitle{Implémentation d'un client POP3}

\author{Pierre Mahé}
\date{\today}
 
\begin{document} 
\maketitle 

\newpage

\section{Extraction des Types Mimes}
\paragraph{}
Pour recuperer la correspondence entre type mime et extension de fichier.\\
Au démarrage le programme, ouvrir le fichier \texttt{/etc/mime.tpyes} et parse son contenu et creer une liste donc chaque cellule est de la forme: type, extension.\\
Si plusieurs extensions sont possible pour le même type, on prend arbitrairement le premier.\\
Quand on va recuperer un mail, le programme va chercher dans la liste l'extension correspondant.

\section{Client en mode textuel}
\paragraph{}
Pour le client textuel, le fonctionnement est simple, le programme se connecte au serveur puis le programme lit les entrées au clavier.
Tant que le message n'est pas \texttt{QUIT}, il va continuer à boucler.\\
Pour connaître la commande qu'a envoyé l'utilisateur, le programme commence par comparer la première lettre puis si elle correspond à une des possibles, donc U,P,L,T,R ou Q.\\
Cela est fait uniquement pour ne pas avoir besoin de faire plusieurs \texttt{strcmp} qui sont plus coûteux.

\paragraph{}
Toutes les fonctionnes retourne les réponses du serveur dans le chaîne sortie, il faut donc faire veiller que le chaîne passé au paramètre soit d'une taille suffisante (dans le programme elle est fixé à 4096).\\
Le main récupère cette chaîne peut l'utiliser pour l'afficher dans la partie textuel ou l'envoyer la à partie graphique pour les autres parties.\\
Comme le nom du fichier l'indique les fonctions sont asses basiques et se contantent de faire une requete au serveur et de traiter la reponse (en garnisant la chaine sortie).\\
Le fonctionnement de la fonction \texttt{retr\_handler} est un peu particuliere. Le programme regarde si le mail est un mail avec des multi-parts. Si c'est un multipart, le programme va chercher le \texttt{Boundary} puis va parcourir le mail et va creer un fichier pour chaque partie du mail.\\
Sinon il écrit simplement le contenu du fichier dans un fichier \texttt{\.txt}.

\section{Client en mode cliquable}
\paragraph{}
Le programme va creer un fenetre avec a l'interieur des sous fenetres pour permertre a l'utilisateur de pouvoir d'entrer ses identifiants et mot de passe.\\
Il va ensuite se connecter avec le serveur. Puis le programme va boucle tant que l'utilisateur n'aura pas cliquer sur le bouton \texttt{Connexion} ou \texttt{Quit}.\\
Une fois connecté, le serveur a faire un requete \texttt{TOP} sur les dix premiers messages du serveur et va traiter les entêtes pour extraire : l’expéditeur, le sujet et le date. Avec ses information, il va initialiser un fenetre listant les dix premiers messages. L'utilisateur n'aura qu'a cliquer sur le messages si il veut récupérer le message.\\
Pour ne pas récupérer plusieurs fois le même message, un tableau listant les messages dejas recuperé a ete intergrer au programme.

\paragraph{}
Si des informations venaient a manquer dans l'entete le programme les remplaceraient par des chaines predefini. 

\paragraph{}
Pour savoir a qui sont destionné les evenements de \texttt{KeyPress} et faire le changement de couleur de fond pour la fenetre active. Le programme garde un pointeur sur la fenetre qui a le focus.

\paragraph{}
On peut noter qu'il y a deux fonctions traitant les \texttt{XEvent} : la premiere \texttt{traiter\_event} sert a traiter les messages pour fenetre de connexion alors que la seconde \texttt{traiter\_event\_mails} sert a traiter les messages sur la fenetre des mails.

\section{Client en mode graphique}
\paragraph{}
Pour cette partie, le main est tres similaire au la partie du main consacré a la partie cliquable.\\
Le programme utise par contre une nouvelle fonctions pour traiter les evenements. Quand l'utilisateur lcique sur un mail, le programme va ouvrir une nouvelle fenetre et va afficher le mail.\\
Les fenetres ouvertes sont stocké dans un tableau pouvant contenir les dix mail. Il permet de  sauvegarder toutes leurs informations, contenu du mail, taille, des mails ouverts.

\paragraph{}
Quand l'utilisateur va cliquer sur un mail, cela va ouvrir une nouvelle fenêtre contenant une sous fenêtre. plus grande contenant le contenu du mail.

\paragraph{}
Quand l'utilisateur va cliquer sur la barre de defilement, a ce moment le logiciel va se metre a capter les mouvenant de la sourie tant que l'utilisateur ne relachera pas le bouton de la sourie. Cela va faire bouger la fenetre inferieur et donc afficher le reste du message. \\

\section{Amelioration et Limitation}
\paragraph{}
Dans la partie graphique, les accents ne sont pas prit en charge. Il aurai donc était intéressant de permettre à l'utilisateur de pouvoir lire des messages avec différentes polices (ou différentes alphabètes). 
\paragraph{}
Lors de la recuperation des mails multipart, le programme utilise les \texttt{boundary} pour delimité les messages, donc la premiere partie du mail compris entre les entetes generales et le prmeiers \texttt{boundary} est ignoré. 

\end{document}